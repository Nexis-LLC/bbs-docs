"use strict";(self.webpackChunkbbs_docs=self.webpackChunkbbs_docs||[]).push([[93],{8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>o});var r=s(6540);const l={},t=r.createContext(l);function i(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:n},e.children)}},9788:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"DevOps/Deployment","title":"Deployment Guide: Kubernetes, Helm & ArgoCD","description":"This document details the deployment workflow using free tools and follows best practices for reliability and repeatability.","source":"@site/docs/04_DevOps/02_Deployment.md","sourceDirName":"04_DevOps","slug":"/DevOps/Deployment","permalink":"/bbs-docs/docs/DevOps/Deployment","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"CI/CD Pipeline Design","permalink":"/bbs-docs/docs/DevOps/CI_CD"},"next":{"title":"Monitoring Guide: Prometheus, Grafana & OpenSearch","permalink":"/bbs-docs/docs/DevOps/Monitoring"}}');var l=s(4848),t=s(8453);const i={},o="Deployment Guide: Kubernetes, Helm & ArgoCD",a={},c=[{value:"1. Kubernetes Cluster Setup",id:"1-kubernetes-cluster-setup",level:2},{value:"Local Development",id:"local-development",level:3},{value:"Cloud (Free Tier)",id:"cloud-free-tier",level:3},{value:"2. Helm Charts Structure",id:"2-helm-charts-structure",level:2},{value:"Key Parameters in <code>values.yaml</code>",id:"key-parameters-in-valuesyaml",level:3},{value:"3. GitHub Actions Workflow",id:"3-github-actions-workflow",level:2},{value:"4. Helm Upgrade &amp; Rollback",id:"4-helm-upgrade--rollback",level:2},{value:"Deploy to Cluster",id:"deploy-to-cluster",level:3},{value:"Rollback",id:"rollback",level:3},{value:"5. GitOps with ArgoCD",id:"5-gitops-with-argocd",level:2},{value:"App-of-Apps Pattern",id:"app-of-apps-pattern",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"deployment-guide-kubernetes-helm--argocd",children:"Deployment Guide: Kubernetes, Helm & ArgoCD"})}),"\n",(0,l.jsxs)(n.p,{children:["This document details the ",(0,l.jsx)(n.strong,{children:"deployment workflow"})," using ",(0,l.jsx)(n.strong,{children:"free tools"})," and follows best practices for reliability and repeatability."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"1-kubernetes-cluster-setup",children:"1. Kubernetes Cluster Setup"}),"\n",(0,l.jsx)(n.h3,{id:"local-development",children:"Local Development"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Kind"})," (Kubernetes in Docker): lightweight, single-node cluster:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kind create cluster --name bus-booking --config kind-config.yaml\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"k3s"}),": minimal Kubernetes distribution:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"curl -sfL https://get.k3s.io | sh -\n"})}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"cloud-free-tier",children:"Cloud (Free Tier)"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Google Kubernetes Engine (GKE Autopilot)"}),": free credits for new accounts."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Azure Kubernetes Service (AKS)"}),": free tier options."]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"2-helm-charts-structure",children:"2. Helm Charts Structure"}),"\n",(0,l.jsxs)(n.p,{children:["Create a chart per service under ",(0,l.jsx)(n.code,{children:"helm/"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"helm/                       # root\n\u2514\u2500\u2500 bus-booking/            # chart for Booking Service\n    \u251c\u2500\u2500 Chart.yaml          # chart metadata\n    \u251c\u2500\u2500 values.yaml         # default values\n    \u251c\u2500\u2500 values-staging.yaml # overrides for staging\n    \u251c\u2500\u2500 values-prod.yaml    # overrides for production\n    \u2514\u2500\u2500 templates/          # Kubernetes manifests templates\n        \u251c\u2500\u2500 deployment.yaml\n        \u251c\u2500\u2500 service.yaml\n        \u251c\u2500\u2500 ingress.yaml\n        \u2514\u2500\u2500 _helpers.tpl    # helper functions\n"})}),"\n",(0,l.jsxs)(n.h3,{id:"key-parameters-in-valuesyaml",children:["Key Parameters in ",(0,l.jsx)(n.code,{children:"values.yaml"})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"image.repository"})," & ",(0,l.jsx)(n.code,{children:"image.tag"})," (e.g. ",(0,l.jsx)(n.code,{children:"ghcr.io/org/bus-booking:SHA"}),")"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"replicaCount"})," (e.g. ",(0,l.jsx)(n.code,{children:"2"})," for staging, ",(0,l.jsx)(n.code,{children:"5"})," for production)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"resources.requests"})," & ",(0,l.jsx)(n.code,{children:"resources.limits"})," (CPU/memory)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"env"})," variables (database URL, Redis URL, API keys)"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"3-github-actions-workflow",children:"3. GitHub Actions Workflow"}),"\n",(0,l.jsx)(n.p,{children:"Automate build \u2192 test \u2192 image push:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# .github/workflows/deploy.yml\name: Build & Deploy\non:\n  push:\n    branches: [ main ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v3\n      - name: Set up Java\n        uses: actions/setup-java@v3\n        with: java-version: '17'\n      - name: Build JAR\n        run: mvn package -DskipTests\n      - name: Build & Push Docker image\n        uses: docker/build-push-action@v3\n        with:\n          context: .\n          push: true\n          tags: |\n            ghcr.io/${{ github.repository }}:${{ github.sha }}\n            ghcr.io/${{ github.repository }}:latest\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"4-helm-upgrade--rollback",children:"4. Helm Upgrade & Rollback"}),"\n",(0,l.jsx)(n.h3,{id:"deploy-to-cluster",children:"Deploy to Cluster"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"helm upgrade --install bus-booking helm/bus-booking \\\n  --values helm/bus-booking/values-prod.yaml \\\n  --set image.tag=${GITHUB_SHA}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"rollback",children:"Rollback"}),"\n",(0,l.jsx)(n.p,{children:"deployment"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"helm rollback bus-booking <revision>\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"5-gitops-with-argocd",children:"5. GitOps with ArgoCD"}),"\n",(0,l.jsx)(n.h3,{id:"app-of-apps-pattern",children:"App-of-Apps Pattern"}),"\n",(0,l.jsx)(n.p,{children:"Store an ArgoCD root application in Git:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"# argocd-root-app.yaml\napiVersion: argoproj.io/v1alpha1\nkind: Application\nmetadata:\n  name: root-app\nspec:\n  project: default\n  source:\n    repoURL: https://github.com/org/repo.git\n    path: helm\n  destination:\n    server: https://kubernetes.default.svc\n    namespace: argocd\n  syncPolicy:\n    automated:\n      prune: true\n      selfHeal: true\n"})}),"\n",(0,l.jsxs)(n.p,{children:["ArgoCD will deploy each service chart under ",(0,l.jsx)(n.code,{children:"helm/"})," automatically."]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Document Version: 1.0"}),"\n",(0,l.jsx)(n.li,{children:"Date: 2025-06-21"}),"\n",(0,l.jsx)(n.li,{children:"Author: ArturChernets"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);