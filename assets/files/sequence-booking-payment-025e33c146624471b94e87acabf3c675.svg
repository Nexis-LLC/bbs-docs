<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1660px" preserveAspectRatio="none" style="width:2185px;height:1660px;background:#FFFFFF;" version="1.1" viewBox="0 0 2185 1660" width="2185px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="398.3359" style="stroke:#181818;stroke-width:1.0;" width="10" x="300" y="67.4297"/><rect fill="#FFFFFF" height="340.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="96.5625"/><rect fill="#FFFFFF" height="177.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="953.5625"/><rect fill="#FFFFFF" height="145.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="1163.4922"/><rect fill="#FFFFFF" height="206.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="1397.4219"/><rect fill="#FFFFFF" height="281.8047" style="stroke:#181818;stroke-width:1.0;" width="10" x="744" y="125.6953"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="744" y="1484.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="552.0313"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="982.6953"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="1192.625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="1426.5547"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1348.5" y="645.4297"/><rect fill="#FFFFFF" height="112.2031" style="stroke:#181818;stroke-width:1.0;" width="10" x="1348.5" y="820.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1619.5" y="674.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1040.9609"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1250.8906"/><rect fill="#FFFFFF" height="32.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1572.2188"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1893" y="1338.2891"/><rect fill="none" height="324.9375" style="stroke:#000000;stroke-width:1.5;" width="2168" x="10" y="169.8281"/><rect fill="none" height="220.7344" style="stroke:#000000;stroke-width:1.5;" width="2148" x="20" y="267.0313"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="309" x="1114.5" y="835.2266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="52" x2="52" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="305" x2="305" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="579.5" x2="579.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="748.5" x2="748.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="890.5" x2="890.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050.5" x2="1050.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1148.5" x2="1148.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1353.5" x2="1353.5" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1624" x2="1624" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1760" x2="1760" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1898" x2="1898" y1="36.2969" y2="1625.3516"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2062" x2="2062" y1="36.2969" y2="1625.3516"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="30" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="37" y="24.9951">User</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="44" x="30" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="37" y="1644.3467">User</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="258" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="265" y="24.9951">API Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="258" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="265" y="1644.3467">API Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="522.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="529.5" y="24.9951">Booking Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="522.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="529.5" y="1644.3467">Booking Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="703.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="710.5" y="24.9951">Seat Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="91" x="703.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="77" x="710.5" y="1644.3467">Seat Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="804.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="811.5" y="24.9951">PostgreSQL (Booking DB)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="804.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="811.5" y="1644.3467">PostgreSQL (Booking DB)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="986.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="993.5" y="24.9951">Redis (Seat Cache)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128" x="986.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114" x="993.5" y="1644.3467">Redis (Seat Cache)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="48" x="1124.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="1131.5" y="24.9951">Kafka</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="48" x="1124.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="1131.5" y="1644.3467">Kafka</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="1293.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1300.5" y="24.9951">Payment Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120" x="1293.5" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106" x="1300.5" y="1644.3467">Payment Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="1568" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1575" y="24.9951">PayPal Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="113" x="1568" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="1575" y="1644.3467">PayPal Gateway</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="1691" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="1698" y="24.9951">Notification Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138" x="1691" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124" x="1698" y="1644.3467">Notification Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1839" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1846" y="24.9951">Timeout Worker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118" x="1839" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="104" x="1846" y="1644.3467">Timeout Worker</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191" x="1967" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="1974" y="24.9951">PostgreSQL (Seat Inventory)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="191" x="1967" y="1624.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="177" x="1974" y="1644.3467">PostgreSQL (Seat Inventory)</text><rect fill="#FFFFFF" height="398.3359" style="stroke:#181818;stroke-width:1.0;" width="10" x="300" y="67.4297"/><rect fill="#FFFFFF" height="340.0703" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="96.5625"/><rect fill="#FFFFFF" height="177.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="953.5625"/><rect fill="#FFFFFF" height="145.6641" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="1163.4922"/><rect fill="#FFFFFF" height="206.9297" style="stroke:#181818;stroke-width:1.0;" width="10" x="575" y="1397.4219"/><rect fill="#FFFFFF" height="281.8047" style="stroke:#181818;stroke-width:1.0;" width="10" x="744" y="125.6953"/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="744" y="1484.8203"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="552.0313"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="982.6953"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="1192.625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="885.5" y="1426.5547"/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="1348.5" y="645.4297"/><rect fill="#FFFFFF" height="112.2031" style="stroke:#181818;stroke-width:1.0;" width="10" x="1348.5" y="820.2266"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1619.5" y="674.5625"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1040.9609"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1250.8906"/><rect fill="#FFFFFF" height="32.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1755" y="1572.2188"/><rect fill="#FFFFFF" height="30" style="stroke:#181818;stroke-width:1.0;" width="10" x="1893" y="1338.2891"/><polygon fill="#181818" points="288,63.4297,298,67.4297,288,71.4297,292,67.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="52" x2="294" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="59" y="62.3638">POST /book {userId, routeId, seatId}</text><polygon fill="#181818" points="563,92.5625,573,96.5625,563,100.5625,567,96.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="569" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="317" y="91.4966">gRPC ReserveSeat(request)</text><polygon fill="#181818" points="732,121.6953,742,125.6953,732,129.6953,736,125.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="738" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="592" y="120.6294">CheckAvailability(seatId)</text><polygon fill="#181818" points="1038.5,150.8281,1048.5,154.8281,1038.5,158.8281,1042.5,154.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="754" x2="1044.5" y1="154.8281" y2="154.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="761" y="149.7622">GET seatId</text><path d="M10,169.8281 L71,169.8281 L71,176.9609 L61,186.9609 L10,186.9609 L10,169.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="324.9375" style="stroke:#000000;stroke-width:1.5;" width="2168" x="10" y="169.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="182.895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="57" x="86" y="182.0386">[Cache hit]</text><polygon fill="#181818" points="765,204.0938,755,208.0938,765,212.0938,761,208.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="759" x2="1049.5" y1="208.0938" y2="208.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="771" y="203.0278">available</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="2178" y1="217.0938" y2="217.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65" x="15" y="227.3042">[Cache miss]</text><polygon fill="#181818" points="2050.5,248.0313,2060.5,252.0313,2050.5,256.0313,2054.5,252.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="754" x2="2056.5" y1="252.0313" y2="252.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="761" y="246.9653">SELECT FOR UPDATE seatId</text><path d="M20,267.0313 L81,267.0313 L81,274.1641 L71,284.1641 L20,284.1641 L20,267.0313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="220.7344" style="stroke:#000000;stroke-width:1.5;" width="2148" x="20" y="267.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="35" y="280.0981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="80" x="96" y="279.2417">[Seat available]</text><polygon fill="#181818" points="765,301.2969,755,305.2969,765,309.2969,761,305.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="759" x2="2061.5" y1="305.2969" y2="305.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="771" y="300.231">locked &amp; available</text><polygon fill="#181818" points="1038.5,330.4297,1048.5,334.4297,1038.5,338.4297,1042.5,334.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="754" x2="1044.5" y1="334.4297" y2="334.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110" x="761" y="329.3638">SET seatId TTL=10s</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="2168" y1="343.4297" y2="343.4297"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="81" x="25" y="353.6401">[Seat occupied]</text><polygon fill="#181818" points="765,374.3672,755,378.3672,765,382.3672,761,378.3672" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="759" x2="2061.5" y1="378.3672" y2="378.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67" x="771" y="373.3013">unavailable</text><polygon fill="#181818" points="596,403.5,586,407.5,596,411.5,592,407.5" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="748" y1="407.5" y2="407.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="602" y="402.4341">error=SeatUnavailable</text><polygon fill="#181818" points="321,432.6328,311,436.6328,321,440.6328,317,436.6328" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="315" x2="579" y1="436.6328" y2="436.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="327" y="431.5669">HTTP 400 {error="Seat unavailable"}</text><polygon fill="#181818" points="63,461.7656,53,465.7656,63,469.7656,59,465.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57" x2="304" y1="465.7656" y2="465.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="69" y="460.6997">HTTP 400 {error="Seat unavailable"}</text><polygon fill="#181818" points="293,475.7656,303,479.7656,293,483.7656,297,479.7656" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="52" x2="299" y1="479.7656" y2="479.7656"/><polygon fill="#181818" points="591,518.8984,581,522.8984,591,526.8984,587,522.8984" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="585" x2="748" y1="522.8984" y2="522.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="597" y="517.8325">available</text><polygon fill="#181818" points="873.5,548.0313,883.5,552.0313,873.5,556.0313,877.5,552.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="580" x2="879.5" y1="552.0313" y2="552.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="587" y="546.9653">INSERT booking(state=PENDING)</text><polygon fill="#181818" points="591,577.1641,581,581.1641,591,585.1641,587,581.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="585" x2="889.5" y1="581.1641" y2="581.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="597" y="576.0981">OK</text><polygon fill="#181818" points="1136.5,609.2969,1146.5,613.2969,1136.5,617.2969,1140.5,613.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="580" x2="1142.5" y1="613.2969" y2="613.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="587" y="608.231">publish SeatReservedEvent</text><path d="M1153,594.1641 L1153,619.1641 L1420,619.1641 L1420,604.1641 L1410,594.1641 L1153,594.1641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1410,594.1641 L1410,604.1641 L1420,604.1641 L1410,594.1641 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="1159" y="611.231">Event used for analytics and microservices</text><polygon fill="#181818" points="1336.5,641.4297,1346.5,645.4297,1336.5,649.4297,1340.5,645.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="580" x2="1342.5" y1="645.4297" y2="645.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245" x="587" y="640.3638">gRPC InitiatePayment(bookingId, amount)</text><polygon fill="#181818" points="1607.5,670.5625,1617.5,674.5625,1607.5,678.5625,1611.5,674.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1358.5" x2="1613.5" y1="674.5625" y2="674.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1365.5" y="669.4966">CreatePayment(amount)</text><polygon fill="#181818" points="1369.5,699.6953,1359.5,703.6953,1369.5,707.6953,1365.5,703.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1363.5" x2="1623.5" y1="703.6953" y2="703.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1375.5" y="698.6294">paymentId, status=PENDING</text><polygon fill="#181818" points="591,728.8281,581,732.8281,591,736.8281,587,732.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="585" x2="1352.5" y1="732.8281" y2="732.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="597" y="727.7622">paymentPending(paymentId)</text><polygon fill="#181818" points="316,757.9609,306,761.9609,316,765.9609,312,761.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="310" x2="579" y1="761.9609" y2="761.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="322" y="756.895">HTTP 200 {bookingId, status=PENDING}</text><polygon fill="#181818" points="63,787.0938,53,791.0938,63,795.0938,59,791.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57" x2="304" y1="791.0938" y2="791.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="229" x="69" y="786.0278">HTTP 200 {bookingId, status=PENDING}</text><polygon fill="#181818" points="1369.5,816.2266,1359.5,820.2266,1369.5,824.2266,1365.5,820.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1363.5" x2="1623.5" y1="820.2266" y2="820.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="1375.5" y="815.1606">webhook PaymentSuccess|PaymentFailed</text><path d="M1114.5,835.2266 L1175.5,835.2266 L1175.5,842.3594 L1165.5,852.3594 L1114.5,852.3594 L1114.5,835.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="309" x="1114.5" y="835.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="1129.5" y="848.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="1190.5" y="847.437">[Payment successful]</text><polygon fill="#181818" points="1159.5,869.4922,1149.5,873.4922,1159.5,877.4922,1155.5,873.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153.5" x2="1347.5" y1="873.4922" y2="873.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="1165.5" y="868.4263">publish PaymentSuccessEvent</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1114.5" x2="1423.5" y1="882.4922" y2="882.4922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87" x="1119.5" y="892.7026">[Payment failed]</text><polygon fill="#181818" points="1159.5,913.4297,1149.5,917.4297,1159.5,921.4297,1155.5,917.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153.5" x2="1347.5" y1="917.4297" y2="917.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1165.5" y="912.3638">publish PaymentFailedEvent</text><polygon fill="#181818" points="596,949.5625,586,953.5625,596,957.5625,592,953.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="590" x2="1147.5" y1="953.5625" y2="953.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="602" y="948.4966">PaymentSuccessEvent</text><polygon fill="#181818" points="873.5,978.6953,883.5,982.6953,873.5,986.6953,877.5,982.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="879.5" y1="982.6953" y2="982.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232" x="592" y="977.6294">UPDATE booking SET state=CONFIRMED</text><polygon fill="#181818" points="596,1007.8281,586,1011.8281,596,1015.8281,592,1011.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="889.5" y1="1011.8281" y2="1011.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="602" y="1006.7622">OK</text><polygon fill="#181818" points="1743,1036.9609,1753,1040.9609,1743,1044.9609,1747,1040.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="1749" y1="1040.9609" y2="1040.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="592" y="1035.895">sendConfirmation(bookingId)</text><polygon fill="#181818" points="596,1066.0938,586,1070.0938,596,1074.0938,592,1070.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="1759" y1="1070.0938" y2="1070.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="602" y="1065.0278">OK</text><polygon fill="#181818" points="1136.5,1095.2266,1146.5,1099.2266,1136.5,1103.2266,1140.5,1099.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="1142.5" y1="1099.2266" y2="1099.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="592" y="1094.1606">publish BookingCompletedEvent</text><polygon fill="#181818" points="316,1127.3594,306,1131.3594,316,1135.3594,312,1131.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="579" y1="1131.3594" y2="1131.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="322" y="1126.2935">send SSE {bookingId, status=CONFIRMED}</text><path d="M590,1112.2266 L590,1137.2266 L784,1137.2266 L784,1122.2266 L774,1112.2266 L590,1112.2266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M774,1112.2266 L774,1122.2266 L784,1122.2266 L774,1112.2266 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="596" y="1129.2935">Frontend receives SSE update</text><polygon fill="#181818" points="596,1159.4922,586,1163.4922,596,1167.4922,592,1163.4922" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="590" x2="1147.5" y1="1163.4922" y2="1163.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="602" y="1158.4263">PaymentFailedEvent</text><polygon fill="#181818" points="873.5,1188.625,883.5,1192.625,873.5,1196.625,877.5,1192.625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="879.5" y1="1192.625" y2="1192.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="592" y="1187.5591">UPDATE booking SET state=FAILED</text><polygon fill="#181818" points="596,1217.7578,586,1221.7578,596,1225.7578,592,1221.7578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="889.5" y1="1221.7578" y2="1221.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="602" y="1216.6919">OK</text><polygon fill="#181818" points="1743,1246.8906,1753,1250.8906,1743,1254.8906,1747,1250.8906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="1749" y1="1250.8906" y2="1250.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="592" y="1245.8247">sendFailureNotification(bookingId)</text><polygon fill="#181818" points="596,1276.0234,586,1280.0234,596,1284.0234,592,1280.0234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="1759" y1="1280.0234" y2="1280.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="602" y="1274.9575">OK</text><polygon fill="#181818" points="1136.5,1305.1563,1146.5,1309.1563,1136.5,1313.1563,1140.5,1309.1563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="580" x2="1142.5" y1="1309.1563" y2="1309.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="587" y="1304.0903">publish BookingFailedEvent</text><polygon fill="#181818" points="1159.5,1334.2891,1149.5,1338.2891,1159.5,1342.2891,1155.5,1338.2891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1153.5" x2="1892" y1="1338.2891" y2="1338.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="1165.5" y="1333.2231">publish BookingTimeoutEvent after 10m</text><polygon fill="#181818" points="596,1393.4219,586,1397.4219,596,1401.4219,592,1397.4219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="590" x2="1147.5" y1="1397.4219" y2="1397.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="602" y="1392.356">BookingTimeoutEvent</text><polygon fill="#181818" points="873.5,1422.5547,883.5,1426.5547,873.5,1430.5547,877.5,1426.5547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="879.5" y1="1426.5547" y2="1426.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="592" y="1421.4888">UPDATE booking SET state=CANCELLED</text><polygon fill="#181818" points="596,1451.6875,586,1455.6875,596,1459.6875,592,1455.6875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="590" x2="889.5" y1="1455.6875" y2="1455.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="602" y="1450.6216">OK</text><polygon fill="#181818" points="732,1480.8203,742,1484.8203,732,1488.8203,736,1484.8203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="738" y1="1484.8203" y2="1484.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="592" y="1479.7544">ReleaseSeat(seatId)</text><polygon fill="#181818" points="2050.5,1509.9531,2060.5,1513.9531,2050.5,1517.9531,2054.5,1513.9531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="754" x2="2056.5" y1="1513.9531" y2="1513.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288" x="761" y="1508.8872">UPDATE seats SET locked = false WHERE seatId = ?</text><polygon fill="#181818" points="1038.5,1539.0859,1048.5,1543.0859,1038.5,1547.0859,1042.5,1543.0859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="749" x2="1044.5" y1="1543.0859" y2="1543.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="756" y="1538.02">DEL seatId</text><polygon fill="#181818" points="1743,1568.2188,1753,1572.2188,1743,1576.2188,1747,1572.2188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="585" x2="1749" y1="1572.2188" y2="1572.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="592" y="1567.1528">sendTimeoutNotification(bookingId)</text><polygon fill="#181818" points="591,1600.3516,581,1604.3516,591,1608.3516,587,1604.3516" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="585" x2="1759" y1="1604.3516" y2="1604.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18" x="597" y="1599.2856">OK</text><path d="M1770,1585.2188 L1770,1610.2188 L2098,1610.2188 L2098,1595.2188 L2088,1585.2188 L1770,1585.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2088,1585.2188 L2088,1595.2188 L2098,1595.2188 L2088,1585.2188 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="1776" y="1602.2856">Timeout cancels PENDING bookings after 10 minutes</text><!--SRC=[pLVVZzeu47xtNs7nKB7IhRgjxWbfhs8XRADoR8varMUJcCKY9DHsg51l__UEVuGumS1krQf5GehjcM_6Cz-CxItXagLiImg94qvsDASS4u5xZuBo7jewoyCel2UIVYLxBG13RCTjkRkoNBFYAQPynrAgPUqKjdDj-PWIwGghiL_Imeplj5nK2ld4QVpV5FTh0-ExgxRAd6PCZ4YwCjXwYFlQX9xjY7yYopNHalghlHYH_OOMBL_jbDzTM8n8NikfJs-yPgLaIvOIoSh2nNRd_GOIjg5b9J-NV6spPcUmcUeXTCZfzJzk0WSuUeWJ_7O1SSFVAiXrcFs5EQXIzI4WFc7sZ4WgsGvK75Nae01c9za3_3IFHX1rGDnH5UO-frygAkHL0zRMGQY30QWk9GPujABfUhWZB2SBbZEvxnl_74X70RdAWEKmO83lWyHk3f7SKW2lc4GOVexazP4JnDZFAQAve5PpmuJGgXsRBMvgieN53dXIylrL3y3YO1gC4ZnvcEF7Q3nCWjefXQKSqpgDIMn_vt6FdSxBT4qp_CO3TIvAyI5AE4ccj-zkp2RrnhNLCashBQFP3pjM5HSyyb6BSbxoMoNsw57Fg9SDX_Kkoxe5yJ598lptpGt-PkoOFkGusdlssUgGkPPmgmGi7ShmX-qu5LYlSYehNfZK51bI_uinRE9sAbx7rTYqtG4EPt4mJ_32JFM51FtRA9YDmzdzSOcFxr2ZxFNduHCw3cQZvdXXMlC0Rwj5piHAEstxJ1Oehg6Y10ZEdbPoWFKCXiQMuMK9lR4W-Hxwfe2l3CesvQKmqCAtuqwdjrqjB9XauAPTxTiWg8P9DcLLk3skZO0wWCQ4EX6Wkt7gOFg0G0vPyMkVSripeHitvACITKBSq3OuBKTyER5u4H1AvVW0VzN1SpU8NbHUxnNjdR2rtNr6f-lgGZsz0jWff4DKFK7zIXShTJZM2rKAN17_s-44gWZQtwbeg1PUNms4qLnMkQxKOoPqYTssQAYjMs-Dk3J6NuLc7BPWq2ZEPD8W-8ZXy-nKmiwt4NlgBUfxeJfmT2iPFSmcuVpVOFnBUudloZM08w_8HcMnP7oZLve2T-hHeufyS2_mq0TrkUzPYL6vsUPKrZazrcjLdzeQZkF0LoI7a9-hFxUtJdXPI0N8QKhPZWgDN6qpq7i1VLmg_cJsJ8RXzBTHH-shujGL-ACPvERXTE9H-v5n6ixAcOENB2K8lxlPDDjkuRW6smjd-ECnzDFRpt0s2gQ_caFjk_0S3Z8Yp6FfDG-RIuyCvsKXz1RjQ-0M3X1rd7p-6CphXmTCVZZxS1e7q_gDSkBY-9fIiIdytQNoidPNlwbJKgHm3cDxgQZP8mvaXtjb0GzeWRu3]--></g></svg>