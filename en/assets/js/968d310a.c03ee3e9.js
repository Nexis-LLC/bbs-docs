"use strict";(self.webpackChunkbbs_docs=self.webpackChunkbbs_docs||[]).push([[8675],{393:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"Reliability/Timeouts_and_Bulkheads","title":"Timeouts and Bulkheads","description":"This document describes best practices for implementing timeouts, bulkheads, and fault isolation to improve service resilience in a Spring Boot microservice architecture.","source":"@site/docs/10_Reliability/03_Timeouts_and_Bulkheads.md","sourceDirName":"10_Reliability","slug":"/Reliability/Timeouts_and_Bulkheads","permalink":"/bbs-docs/en/docs/Reliability/Timeouts_and_Bulkheads","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Circuit Breakers & Retries","permalink":"/bbs-docs/en/docs/Reliability/Circuit_Breakers_and_Retries"}}');var t=i(4848),r=i(8453);const l={},a="Timeouts and Bulkheads",c={},o=[{value:"Overview",id:"overview",level:2},{value:"1. Timeout Strategy",id:"1-timeout-strategy",level:2},{value:"1.1 HTTP Client (RestTemplate/WebClient)",id:"11-http-client-resttemplatewebclient",level:3},{value:"WebClient Example:",id:"webclient-example",level:4},{value:"1.2 Feign Clients",id:"12-feign-clients",level:3},{value:"1.3 Database",id:"13-database",level:3},{value:"2. Bulkhead Patterns",id:"2-bulkhead-patterns",level:2},{value:"2.1 Thread Pool Isolation",id:"21-thread-pool-isolation",level:3},{value:"2.2 Semaphore Bulkhead",id:"22-semaphore-bulkhead",level:3},{value:"3. Isolation Techniques",id:"3-isolation-techniques",level:2},{value:"3.1 Circuit Breakers",id:"31-circuit-breakers",level:3},{value:"3.2 Async Isolation",id:"32-async-isolation",level:3},{value:"4. Best Practices",id:"4-best-practices",level:2},{value:"5. Monitoring",id:"5-monitoring",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"timeouts-and-bulkheads",children:"Timeouts and Bulkheads"})}),"\n",(0,t.jsxs)(n.p,{children:["This document describes best practices for implementing ",(0,t.jsx)(n.strong,{children:"timeouts"}),", ",(0,t.jsx)(n.strong,{children:"bulkheads"}),", and ",(0,t.jsx)(n.strong,{children:"fault isolation"})," to improve service resilience in a Spring Boot microservice architecture."]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsxs)(n.p,{children:["Modern distributed systems are vulnerable to cascading failures. Implementing ",(0,t.jsx)(n.strong,{children:"timeouts"}),", ",(0,t.jsx)(n.strong,{children:"bulkheads"}),", and ",(0,t.jsx)(n.strong,{children:"isolation strategies"})," helps prevent systemic outages by ensuring that failures in one component do not overwhelm others."]}),"\n",(0,t.jsx)(n.p,{children:"This document is focused on:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Timeouts"}),": To prevent thread blocking from long operations."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Bulkheads"}),": To isolate failures and limit concurrency."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Isolation patterns"}),": To ensure high availability and resilience under load."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"1-timeout-strategy",children:"1. Timeout Strategy"}),"\n",(0,t.jsx)(n.h3,{id:"11-http-client-resttemplatewebclient",children:"1.1 HTTP Client (RestTemplate/WebClient)"}),"\n",(0,t.jsxs)(n.p,{children:["Use ",(0,t.jsx)(n.code,{children:"WebClient"})," (or ",(0,t.jsx)(n.code,{children:"RestTemplate"}),") with proper timeout configurations."]}),"\n",(0,t.jsx)(n.h4,{id:"webclient-example",children:"WebClient Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Bean\npublic WebClient webClient() {\n    return WebClient.builder()\n        .clientConnector(new ReactorClientHttpConnector(\n            HttpClient.create()\n                .responseTimeout(Duration.ofSeconds(3))\n                .option(ChannelOption.CONNECT_TIMEOUT_MILLIS, 1000)\n        ))\n        .build();\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"12-feign-clients",children:"1.2 Feign Clients"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"feign:\n  client:\n    config:\n      default:\n        connectTimeout: 1000\n        readTimeout: 3000\n"})}),"\n",(0,t.jsx)(n.h3,{id:"13-database",children:"1.3 Database"}),"\n",(0,t.jsx)(n.p,{children:"Use connection and query timeouts in the connection pool:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-properties",children:"spring.datasource.hikari.connection-timeout=3000\nspring.datasource.hikari.validation-timeout=1000\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"2-bulkhead-patterns",children:"2. Bulkhead Patterns"}),"\n",(0,t.jsx)(n.h3,{id:"21-thread-pool-isolation",children:"2.1 Thread Pool Isolation"}),"\n",(0,t.jsxs)(n.p,{children:["Using ",(0,t.jsx)(n.a,{href:"https://resilience4j.readme.io/docs/bulkhead",children:"Resilience4j Bulkhead"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Bulkhead(name = "externalService", type = Bulkhead.Type.THREADPOOL)\npublic String callExternalService() {\n    return externalApi.call();\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Configure the pool in ",(0,t.jsx)(n.code,{children:"application.yml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"resilience4j.bulkhead:\n  instances:\n    externalService:\n      maxConcurrentCalls: 10\n      maxWaitDuration: 500ms\n"})}),"\n",(0,t.jsx)(n.h3,{id:"22-semaphore-bulkhead",children:"2.2 Semaphore Bulkhead"}),"\n",(0,t.jsx)(n.p,{children:"Limits concurrent executions using semaphores:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Bulkhead(name = "limitedService", type = Bulkhead.Type.SEMAPHORE)\npublic String callLimitedService() {\n    return anotherCall();\n}\n'})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"3-isolation-techniques",children:"3. Isolation Techniques"}),"\n",(0,t.jsx)(n.h3,{id:"31-circuit-breakers",children:"3.1 Circuit Breakers"}),"\n",(0,t.jsxs)(n.p,{children:["Combine bulkheads with circuit breakers (see ",(0,t.jsx)(n.code,{children:"Resilience4j"}),"):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@CircuitBreaker(name = "externalApi", fallbackMethod = "fallback")\n@Bulkhead(name = "externalApi", type = Bulkhead.Type.THREADPOOL)\npublic String fetchData() {\n    return externalService.get();\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"32-async-isolation",children:"3.2 Async Isolation"}),"\n",(0,t.jsx)(n.p,{children:"Use async patterns to release calling threads:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Async\npublic CompletableFuture<String> fetchData() {\n    return CompletableFuture.completedFuture(externalApi.get());\n}\n"})}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"4-best-practices",children:"4. Best Practices"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Always configure timeouts for ",(0,t.jsx)(n.strong,{children:"external API calls"}),", ",(0,t.jsx)(n.strong,{children:"DB queries"}),", and ",(0,t.jsx)(n.strong,{children:"message brokers"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.strong,{children:"Resilience4j"})," or ",(0,t.jsx)(n.strong,{children:"Spring Cloud Circuit Breaker"})," for bulkhead and timeout patterns."]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.strong,{children:"separate thread pools"})," for each external dependency."]}),"\n",(0,t.jsxs)(n.li,{children:["Apply ",(0,t.jsx)(n.strong,{children:"fallback methods"})," to gracefully degrade service."]}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.h2,{id:"5-monitoring",children:"5. Monitoring"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Monitor timeout exceptions, rejected calls, and fallback invocations via ",(0,t.jsx)(n.strong,{children:"Micrometer"}),"."]}),"\n",(0,t.jsx)(n.li,{children:"Alert on sustained circuit breaker open states or thread pool exhaustion."}),"\n"]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Document Version: 1.0"}),"\n",(0,t.jsx)(n.li,{children:"Date: 2025-06-24"}),"\n",(0,t.jsx)(n.li,{children:"Author: ArturChernets"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);