"use strict";(self.webpackChunkbbs_docs=self.webpackChunkbbs_docs||[]).push([[751],{3992:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"DevOps/Secrets_Management","title":"Secrets Management: SOPS & Sealed Secrets","description":"This document outlines free and secure approaches to storing and deploying secrets in Kubernetes.","source":"@site/docs/04_DevOps/04_Secrets_Management.md","sourceDirName":"04_DevOps","slug":"/DevOps/Secrets_Management","permalink":"/bbs-docs/en/docs/DevOps/Secrets_Management","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Monitoring Guide: Prometheus, Grafana & OpenSearch","permalink":"/bbs-docs/en/docs/DevOps/Monitoring"},"next":{"title":"5. API","permalink":"/bbs-docs/en/docs/api"}}');var l=n(4848),t=n(8453);const i={},c="Secrets Management: SOPS & Sealed Secrets",a={},d=[{value:"1. SOPS (Secret OPerationS)",id:"1-sops-secret-operations",level:2},{value:"Overview",id:"overview",level:3},{value:"Setup",id:"setup",level:3},{value:"Usage in CI/CD",id:"usage-in-cicd",level:3},{value:"2. Sealed Secrets (Bitnami)",id:"2-sealed-secrets-bitnami",level:2},{value:"Overview",id:"overview-1",level:3},{value:"Installation",id:"installation",level:3},{value:"Workflow",id:"workflow",level:3},{value:"3. Best Practices",id:"3-best-practices",level:2}];function o(e){const s={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"secrets-management-sops--sealed-secrets",children:"Secrets Management: SOPS & Sealed Secrets"})}),"\n",(0,l.jsxs)(s.p,{children:["This document outlines ",(0,l.jsx)(s.strong,{children:"free"})," and ",(0,l.jsx)(s.strong,{children:"secure"})," approaches to storing and deploying secrets in Kubernetes."]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"1-sops-secret-operations",children:"1. SOPS (Secret OPerationS)"}),"\n",(0,l.jsx)(s.h3,{id:"overview",children:"Overview"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Encrypt YAML files in Git using a public GPG key. Decrypt only at deploy time."}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"setup",children:"Setup"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Generate GPG key"})," (if not existing):"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"gpg --full-generate-key\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Encrypt a secret"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"sops --encrypt --pgp <GPG_KEY_ID> secret-values.yaml > secret-values.enc.yaml\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Commit"})," the encrypted file (",(0,l.jsx)(s.code,{children:".enc.yaml"}),") to Git (safe to share)."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"usage-in-cicd",children:"Usage in CI/CD"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"GitHub Actions"})," step to decrypt:"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-yaml",children:"- name: Decrypt secrets\n  run: |\n    gpg --import private.key\n    sops --decrypt secret-values.enc.yaml > secret-values.yaml\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:["Use ",(0,l.jsx)(s.code,{children:"secret-values.yaml"})," as ",(0,l.jsx)(s.code,{children:"helm --values"})," input."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"2-sealed-secrets-bitnami",children:"2. Sealed Secrets (Bitnami)"}),"\n",(0,l.jsx)(s.h3,{id:"overview-1",children:"Overview"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Kubernetes controller that decrypts ",(0,l.jsx)(s.code,{children:"SealedSecret"})," objects into native ",(0,l.jsx)(s.code,{children:"Secret"})," at runtime."]}),"\n",(0,l.jsx)(s.li,{children:"Uses cluster-only private key, so sealed secrets are safe in Git."}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"installation",children:"Installation"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"kubectl apply -f \\\n  https://github.com/bitnami-labs/sealed-secrets/releases/download/v0.17.5/controller.yaml\n"})}),"\n",(0,l.jsx)(s.h3,{id:"workflow",children:"Workflow"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Create plain secret"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"kubectl create secret generic db-creds \\\n  --from-literal=username=admin \\\n  --from-literal=password=s3cr3t \\\n  --dry-run=client -o yaml > secret.yaml\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Seal it"}),":"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"kubeseal < secret.yaml > sealedsecret.yaml\n"})}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"Commit"})," ",(0,l.jsx)(s.code,{children:"sealedsecret.yaml"})," to Git."]}),"\n"]}),"\n",(0,l.jsxs)(s.li,{children:["\n",(0,l.jsxs)(s.p,{children:[(0,l.jsx)(s.strong,{children:"ArgoCD"})," or manual ",(0,l.jsx)(s.code,{children:"kubectl apply -f sealedsecret.yaml"})," will create the real ",(0,l.jsx)(s.code,{children:"Secret"})," in the cluster."]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsx)(s.h2,{id:"3-best-practices",children:"3. Best Practices"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Rotate keys"}),": Regularly rotate GPG keys and SealedSecrets controller keys."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Audit logs"}),": Enable audit logging in Kubernetes to track secret access."]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Least privilege"}),": Limit which namespaces/service accounts can decrypt secrets."]}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Document Version: 1.0"}),"\n",(0,l.jsx)(s.li,{children:"Date: 2025-06-21"}),"\n",(0,l.jsx)(s.li,{children:"Author: ArturChernets"}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>i,x:()=>c});var r=n(6540);const l={},t=r.createContext(l);function i(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);